<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>æŠ¤çœ¼é…è‰²å±•ç¤º â€“ Eyeâ€‘Friendly Colors</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="å±•ç¤ºå‡ å¥—ç»è¿‡ç§‘ç ”ã€æ ‡å‡†éªŒè¯çš„æŠ¤çœ¼é…è‰²æ–¹æ¡ˆï¼Œå®æ—¶å¯¹æ¯”åº¦æ£€æŸ¥ï¼Œæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰é…è‰²å¹¶ç»™å‡ºåˆè§„æç¤ºã€‚">
<meta name="author" content="Your Name">

<style>
/* ---------- å…¨å±€å˜é‡ & é¢œè‰²æ–¹æ¡ˆ ---------- */
:root{
    --bg:#ffffff;      /* é¡µé¢èƒŒæ™¯ */
    --fg:#212121;      /* æ­£æ–‡æ–‡å­— */
    --accent:#4caf50;  /* å¼ºè°ƒè‰²ï¼ˆé“¾æ¥ã€å¡ç‰‡é«˜äº®ï¼‰ */
    --radius:.5rem;
}

/* é¢„è®¾é…è‰²æ–¹æ¡ˆï¼ˆå¯¹åº”å¡ç‰‡çš„ .schemeâ€‘Xï¼‰ */
.scheme-1{--bg:#121212;--fg:#E0E0E0;}
.scheme-2{--bg:#1E1E1E;--fg:#C5C5C5;}
.scheme-3{--bg:#0F0F0F;--fg:#FFFFFF;}
.scheme-4{--bg:#F5F5F5;--fg:#212121;}
.scheme-5{--bg:#FAFAFA;--fg:#222222;}
.scheme-6{--bg:#FFFAE3;--fg:#212121;}

/* ---------- åŸºç¡€é¡µé¢æ ·å¼ ---------- */
body{
    margin:0;
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
    background:var(--bg);
    color:var(--fg);
    line-height:1.6;
    transition:background .3s,color .3s;
}
header{
    padding:1.5rem 1rem;
    text-align:center;
    background:linear-gradient(135deg,rgba(255,255,255,.05),transparent);
}
header h1{margin:0;font-size:2rem;font-weight:600;}
main{max-width:1200px;margin:0 auto;padding:1rem;}
.grid{display:grid;gap:1.5rem;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));}

/* å¡ç‰‡é€šç”¨ */
.card{
    background:var(--bg);
    color:var(--fg);
    border-radius:var(--radius);
    box-shadow:0 2px 6px rgba(0,0,0,.12);
    overflow:hidden;
    cursor:pointer;
    transition:transform .2s,box-shadow .2s;
}
.card:hover{transform:translateY(-3px);box-shadow:0 6px 12px rgba(0,0,0,.15);}
.card-header{padding:.8rem 1rem;background:rgba(0,0,0,.04);font-weight:600;border-bottom:1px solid rgba(0,0,0,.08);}
.card-body{padding:1rem;font-size:.95rem;}
.contrast{margin-top:.5rem;font-size:.85rem;font-family:"Courier New",monospace;}
.active-scheme{outline:3px solid var(--accent);outline-offset:-3px;}

/* è‡ªå®šä¹‰é…è‰²è¡¨å• */
#custom-form{
    margin:1rem 0;
    padding:1rem;
    border:1px solid rgba(0,0,0,.12);
    border-radius:var(--radius);
    background:rgba(0,0,0,.02);
}
#custom-form label{
    display:inline-block;
    margin-right:.8rem;
    font-weight:600;
}
#custom-form input[type="color"]{
    width:2.5rem;height:2.5rem;border:none;background:none;
    cursor:pointer;
}
#custom-form button{
    margin-left:1rem;
    padding:.4rem .8rem;
    background:var(--accent);
    color:#fff;
    border:none;border-radius:.3rem;
    cursor:pointer;
}

/* Footer */
footer{text-align:center;padding:2rem 1rem;font-size:.85rem;opacity:.7;}
a{color:var(--accent);text-decoration:underline;}
@media (prefers-color-scheme:dark){
    :root{--accent:#64ffda;}
}
@media (prefers-reduced-motion:reduce){
    *,*::before,*::after{transition-duration:0s!important;}
}
</style>
</head>

<body class="scheme-1"><!-- é»˜è®¤é…è‰² scheme-1 -->
<header>
    <h1>æŠ¤çœ¼é…è‰²å±•ç¤º ğŸ¨</h1>
    <p>ç‚¹å‡»ä»»æ„å¡ç‰‡å³å¯åœ¨æœ¬é¡µé¢å®æ—¶é¢„è§ˆè¯¥é…è‰²çš„è§†è§‰æ•ˆæœ</p>
</header>

<main>
    <!-- ---------- è‡ªå®šä¹‰é…è‰²è¡¨å• ---------- -->
    <section id="custom-form">
        <h2 style="margin-top:0;">ğŸ”§ è‡ªå®šä¹‰é…è‰²ï¼ˆå³ä½¿ä¸è¾¾æ ‡ä¹Ÿå¯é¢„è§ˆï¼‰</h2>
        <label for="bg-picker">èƒŒæ™¯é¢œè‰²ï¼š</label>
        <input type="color" id="bg-picker" value="#121212">
        <label for="fg-picker">å‰æ™¯é¢œè‰²ï¼š</label>
        <input type="color" id="fg-picker" value="#E0E0E0">
        <button id="apply-custom">é¢„è§ˆé…è‰²</button>
    </section>

    <!-- ---------- é¢„å®šä¹‰é…è‰²å¡ç‰‡ ---------- -->
    <section class="grid" id="palette">
        <article class="card scheme-1" data-name="æš—å…‰é˜…è¯»" data-bg="#121212" data-fg="#E0E0E0">
            <div class="card-header">æš—å…‰é˜…è¯»</div>
            <div class="card-body">
                èƒŒæ™¯ <code>#121212</code> / å‰æ™¯ <code>#E0E0E0</code><br>
                <span class="contrast">å¯¹æ¯”åº¦ï¼š<span class="ratio"></span>ï¼ˆWCAG&nbsp;AAï¼‰</span>
            </div>
        </article>

        <article class="card scheme-2" data-name="å¤œé—´ä»£ç " data-bg="#1E1E1E" data-fg="#C5C5C5">
            <div class="card-header">å¤œé—´ä»£ç </div>
            <div class="card-body">
                èƒŒæ™¯ <code>#1E1E1E</code> / å‰æ™¯ <code>#C5C5C5</code><br>
                <span class="contrast">å¯¹æ¯”åº¦ï¼š<span class="ratio"></span>ï¼ˆWCAG&nbsp;AAï¼‰</span>
            </div>
        </article>

        <article class="card scheme-3" data-name="è§†é¢‘è§‚çœ‹" data-bg="#0F0F0F" data-fg="#FFFFFF">
            <div class="card-header">è§†é¢‘è§‚çœ‹</div>
            <div class="card-body">
                èƒŒæ™¯ <code>#0F0F0F</code> / å‰æ™¯ <code>#FFFFFF</code><br>
                <span class="contrast">å¯¹æ¯”åº¦ï¼š<span class="ratio"></span>ï¼ˆWCAG&nbsp;AAï¼‰</span>
            </div>
        </article>

        <article class="card scheme-4" data-name="æ–‡æ¡£ç¼–è¾‘" data-bg="#F5F5F5" data-fg="#212121">
            <div class="card-header">æ–‡æ¡£ç¼–è¾‘</div>
            <div class="card-body">
                èƒŒæ™¯ <code>#F5F5F5</code> / å‰æ™¯ <code>#212121</code><br>
                <span class="contrast">å¯¹æ¯”åº¦ï¼š<span class="ratio"></span>ï¼ˆWCAG&nbsp;AAï¼‰</span>
            </div>
        </article>

        <article class="card scheme-5" data-name="å„¿ç«¥å­¦ä¹ " data-bg="#FAFAFA" data-fg="#222222">
            <div class="card-header">å„¿ç«¥å­¦ä¹ </div>
            <div class="card-body">
                èƒŒæ™¯ <code>#FAFAFA</code> / å‰æ™¯ <code>#222222</code><br>
                <span class="contrast">å¯¹æ¯”åº¦ï¼š<span class="ratio"></span>ï¼ˆWCAG&nbsp;AAï¼‰</span>
            </div>
        </article>

        <article class="card scheme-6" data-name="æš–é»„å¤œé—´" data-bg="#FFFAE3" data-fg="#212121">
            <div class="card-header">æš–é»„å¤œé—´</div>
            <div class="card-body">
                èƒŒæ™¯ <code>#FFFAE3</code> / å‰æ™¯ <code>#212121</code><br>
                <span class="contrast">å¯¹æ¯”åº¦ï¼š<span class="ratio"></span>ï¼ˆWCAG&nbsp;AAï¼‰</span>
            </div>
        </article>

        <!-- ======== è‡ªå®šä¹‰å¡ç‰‡ï¼ˆè¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆï¼‰ ======== -->
        <article class="card" id="custom-card" style="display:none;">
            <div class="card-header">è‡ªå®šä¹‰é…è‰²</div>
            <div class="card-body">
                èƒŒæ™¯ <code id="custom-bg-code"></code> / å‰æ™¯ <code id="custom-fg-code"></code><br>
                <span class="contrast">å¯¹æ¯”åº¦ï¼š<span class="ratio"></span>ï¼ˆWCAG&nbsp;AAï¼‰</span>
            </div>
        </article>
    </section>
</main>

<footer>
    <p place-items: "center">Â© 20251001 Mr haoqixin â€“ CC BY 4.0</p>
</footer>

<script>
/* ---------- å¯¹æ¯”åº¦è®¡ç®—ï¼ˆWCAGï¼‰ ---------- */
function luminance(hex){
    const rgb = hex.replace('#','').match(/.{2}/g).map(v=>parseInt(v,16)/255);
    const sRGB = rgb.map(c=>c<=0.03928?c/12.92:Math.pow((c+0.055)/1.055,2.4));
    return 0.2126*sRGB[0] + 0.7152*sRGB[1] + 0.0722*sRGB[2];
}
function contrastRatio(bg,fg){
    const L1 = luminance(bg), L2 = luminance(fg);
    return (Math.max(L1,L2)+0.05)/(Math.min(L1,L2)+0.05);
}
function fmtRatio(r){return (Math.round(r*100)/100).toFixed(2)+':1';}

/* ---------- ä¸ºæ‰€æœ‰å¡ç‰‡ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰ï¼‰å¡«å……å¯¹æ¯”åº¦ ---------- */
/* ---------- ä¸ºæ‰€æœ‰å¡ç‰‡ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰ï¼‰å¡«å……å¯¹æ¯”åº¦ ---------- */
function setCardContrast(card){
    const bg = card.dataset.bg;
    const fg = card.dataset.fg;
    const ratio = contrastRatio(bg,fg);
    const span = card.querySelector('.ratio');
    span.textContent = fmtRatio(ratio);

    // --- ä¿®æ”¹ï¼šæŸ¥æ‰¾å¹¶å¯èƒ½ç§»é™¤å·²å­˜åœ¨çš„è­¦å‘Šæ ‡ç­¾ ---
    let warn = card.querySelector('.warning');
    // ------------------------------------------------

    if (ratio >= 7){
        span.style.color = '#0a8';
        span.title = 'AAA çº§å¯¹æ¯”åº¦ï¼ˆæ¨èï¼‰';
        // --- æ–°å¢ï¼šå¦‚æœè¾¾æ ‡ï¼Œç§»é™¤è­¦å‘Šæ ‡ç­¾ ---
        if (warn) warn.remove();
        // ----------------------------------------
    }else if (ratio >= 4.5){
        span.style.color = '#ffb400';
        span.title = 'AA çº§å¯¹æ¯”åº¦ï¼ˆå¯æ¥å—ï¼‰';
        // --- æ–°å¢ï¼šå¦‚æœè¾¾æ ‡ï¼Œç§»é™¤è­¦å‘Šæ ‡ç­¾ ---
        if (warn) warn.remove();
        // ----------------------------------------
    }else{
        span.style.color = '#e53935';
        span.title = 'å¯¹æ¯”åº¦ä¸è¶³ï¼ˆä¸æ¨èä½¿ç”¨ï¼‰';
        // --- ä¿®æ”¹ï¼šåªæœ‰åœ¨æ²¡æœ‰è­¦å‘Šæ ‡ç­¾æ—¶æ‰åˆ›å»º ---
        if (!warn){
            warn = document.createElement('div');
            warn.className = 'warning';
            warn.style.position = 'absolute';
            warn.style.right = '.5rem';
            warn.style.bottom = '.5rem';
            warn.style.background = 'rgba(229,57,53,0.85)';
            warn.style.color = '#fff';
            warn.style.padding = '2px 6px';
            warn.style.borderRadius = '.3rem';
            warn.style.fontSize = '.75rem';
            warn.textContent = 'ä¸æ¨è';
            card.style.position = 'relative';
            card.appendChild(warn);
        }
        // ------------------------------------------
    }
}

/* ---------- åˆå§‹åŒ–é¢„ç½®å¡ç‰‡ ---------- */
document.querySelectorAll('.card').forEach(c => {
    if (c.dataset.bg && c.dataset.fg) setCardContrast(c);
});

/* ---------- é¡µé¢é…è‰²åˆ‡æ¢ï¼ˆç³»ç»Ÿé…è‰²ï¼‰ ---------- */
const body = document.body;
const cards = document.querySelectorAll('.card:not(#custom-card)'); // æ’é™¤è‡ªå®šä¹‰å¡ç‰‡
const customCard = document.getElementById('custom-card');

// åº”ç”¨é¢„è®¾é…è‰²æ–¹æ¡ˆ
function applyScheme(schemeClass){
    body.style.removeProperty('--bg');
    body.style.removeProperty('--fg');
    body.className = ''; 
    body.classList.add(schemeClass); 
    document.querySelectorAll('.card').forEach(c => c.classList.remove('active-scheme'));
    customCard.classList.remove('active-scheme');
    const active = document.querySelector(`.card.${schemeClass}`);
    if (active) active.classList.add('active-scheme');
}

// åº”ç”¨è‡ªå®šä¹‰é…è‰²æ–¹æ¡ˆ
function applyCustomScheme(bg, fg) {
    body.style.setProperty('--bg', bg);
    body.style.setProperty('--fg', fg);
    
    // ç§»é™¤æ‰€æœ‰å¡ç‰‡çš„é«˜äº®
    document.querySelectorAll('.card').forEach(c => c.classList.remove('active-scheme'));
    // ä¸ºè‡ªå®šä¹‰å¡ç‰‡æ·»åŠ é«˜äº®
    customCard.classList.add('active-scheme');
}

// ä½¿ç”¨äº‹ä»¶å§”æ‰˜ä¸ºæ‰€æœ‰å¡ç‰‡æ·»åŠ ç‚¹å‡»äº‹ä»¶
const palette = document.getElementById('palette');
palette.addEventListener('click', function(e) {
    const card = e.target.closest('.card');
    if (!card) return;

    const scheme = [...card.classList].find(cls => cls.startsWith('scheme-'));
    
    // æƒ…å†µ1: ç‚¹å‡»äº†é¢„è®¾é…è‰²å¡ç‰‡
    if (scheme) {
        applyScheme(scheme);
        localStorage.setItem('eyeFriendlyScheme', scheme);
        localStorage.removeItem('customBg');
        localStorage.removeItem('customFg');
        return;
    }

    // æƒ…å†µ2: ç‚¹å‡»äº†è‡ªå®šä¹‰é…è‰²å¡ç‰‡
    if (card.id === 'custom-card') {
        const bg = card.dataset.bg;
        const fg = card.dataset.fg;
        if (bg && fg) {
            applyCustomScheme(bg, fg);
            // å­˜å‚¨è‡ªå®šä¹‰é…è‰²
            localStorage.setItem('eyeFriendlyScheme', 'scheme-custom');
            localStorage.setItem('customBg', bg);
            localStorage.setItem('customFg', fg);
        }
    }
});

/* ---------- è¯»å–æœ¬åœ°å­˜å‚¨çš„ä¸Šä¸€æ¬¡é€‰æ‹© ---------- */
(function () {
    const saved = localStorage.getItem('eyeFriendlyScheme');
    if (saved === 'scheme-custom') {
        const savedBg = localStorage.getItem('customBg');
        const savedFg = localStorage.getItem('customFg');
        if (savedBg && savedFg) {
            // æ¨¡æ‹Ÿç‚¹å‡»â€œé¢„è§ˆé…è‰²â€æŒ‰é’®ï¼Œä»¥å¡«å……è‡ªå®šä¹‰å¡ç‰‡
            document.getElementById('bg-picker').value = savedBg;
            document.getElementById('fg-picker').value = savedFg;
            document.getElementById('apply-custom').click();
            // ç„¶ååº”ç”¨é…è‰²
            applyCustomScheme(savedBg, savedFg);
        }
    } else if (saved) {
        applyScheme(saved);
    }
})();

/* ---------- è‡ªå®šä¹‰é…è‰²äº¤äº’ ---------- */
const bgPicker = document.getElementById('bg-picker');
const fgPicker = document.getElementById('fg-picker');
const applyBtn = document.getElementById('apply-custom');
const customBgCode = document.getElementById('custom-bg-code');
const customFgCode = document.getElementById('custom-fg-code');

applyBtn.addEventListener('click',()=>{
    const bg = bgPicker.value.toUpperCase();
    const fg = fgPicker.value.toUpperCase();

    // ä¸ºè‡ªå®šä¹‰å¡ç‰‡è®¾ç½® dataâ€‘å±æ€§ï¼Œä¾¿äºé€šç”¨å‡½æ•° reuse
    customCard.dataset.bg = bg;
    customCard.dataset.fg = fg;
    customBgCode.textContent = bg;
    customFgCode.textContent = fg;

    // è®¡ç®—å¹¶å±•ç¤ºå¯¹æ¯”åº¦ï¼ˆåŒ…æ‹¬è­¦ç¤ºï¼‰
    setCardContrast(customCard);

    // æ˜¾ç¤ºå¡ç‰‡ï¼ˆç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶é»˜è®¤éšè—ï¼‰
    customCard.style.display = 'block';
});
</script>
